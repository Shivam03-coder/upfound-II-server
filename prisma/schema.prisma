generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id               String       @id @default(uuid())
    jobSeekerProfile JobSeeker?
    role             UserRole?
    post             Post[]
    entityLike       EntityLike[]
    comment          Comment[]
    createdAt        DateTime     @default(now())
    updatedAt        DateTime     @updatedAt
    experience       Experience?
    recruiter        Recruiter?
    profile          Profile?
    authProvider     AuthProvider @default(GOOGLE)

    @@map("users")
}

model JobSeeker {
    id                    String                       @id @default(uuid())
    userId                String                       @unique
    user                  User                         @relation(fields: [userId], references: [id], onDelete: Cascade)
    primaryInterest       PrimaryInterest?
    location              String?
    isPhoneNumberVerified Boolean                      @default(false)
    status                JobSeekerStatus?
    profileView           Int                          @default(0)
    searchView            Int                          @default(0)
    projectLinks          JobSeekerProjectLink?
    technicalProfile      JobSeekerTechnicalProfile?
    preferences           JobSeekerPreferences?
    education             JobSeekerEducation?
    documents             JobSeekerDocument[]
    culturePreferences    JobSeekerCulturePreferences?
    createdAt             DateTime                     @default(now())
    updatedAt             DateTime                     @updatedAt

    @@index([isPhoneNumberVerified])
    @@index([status])
    @@index([profileView])
    @@index([searchView])
    @@index([location])
    @@map("job_seekers")
}

model JobSeekerProjectLink {
    id          String    @id @default(uuid())
    jobSeeker   JobSeeker @relation(fields: [jobSeekerId], references: [id], onDelete: Cascade)
    jobSeekerId String    @unique
    projectLink String[]

    @@map("job_seeker_project_link")
}

model JobSeekerTechnicalProfile {
    id                String                   @id @default(uuid())
    jobSeeker         JobSeeker                @relation(fields: [jobSeekerId], references: [id], onDelete: Cascade)
    jobSeekerId       String                   @unique
    desiredRoles      String[]
    skills            String[]
    certifications    JobSeekerCertification[]
    yearsOfExperience String?
    createdAt         DateTime                 @default(now())
    updatedAt         DateTime                 @updatedAt

    @@map("job_seeker_technical_profile")
}

model JobSeekerCertification {
    id                 String                    @id @default(uuid())
    name               String
    institution        String
    graduationYear     Int
    technicalProfile   JobSeekerTechnicalProfile @relation(fields: [technicalProfileId], references: [id], onDelete: Cascade)
    technicalProfileId String

    @@map("job_seeker_certifications")
}

model JobSeekerPreferences {
    id                     String                 @id @default(uuid())
    jobSeeker              JobSeeker              @relation(fields: [jobSeekerId], references: [id], onDelete: Cascade)
    jobSeekerId            String                 @unique
    activelyLooking        ActivelyLookingStatus
    workArrangement        WorkArrangement
    startupStagePreference StartupStagePreference
    jobType                JobType
    createdAt              DateTime               @default(now())
    updatedAt              DateTime               @updatedAt

    @@map("job_seeker_preferences")
}

model JobSeekerEducation {
    id          String                   @id @default(uuid())
    jobSeeker   JobSeeker                @relation(fields: [jobSeekerId], references: [id], onDelete: Cascade)
    jobSeekerId String                   @unique
    education   JobSeekerEducationItem[]
    createdAt   DateTime                 @default(now())
    updatedAt   DateTime                 @updatedAt

    @@map("job_seeker_education")
}

model JobSeekerEducationItem {
    id             String             @id @default(uuid())
    degree         String
    institution    String
    graduationYear Int?
    education      JobSeekerEducation @relation(fields: [educationId], references: [id], onDelete: Cascade)
    educationId    String

    @@map("job_seeker_education_item")
}

model JobSeekerDocument {
    id           String       @id @default(uuid())
    jobSeeker    JobSeeker    @relation(fields: [jobSeekerId], references: [id], onDelete: Cascade)
    jobSeekerId  String
    documentUrl  String
    documentType DocumentType @default(RESUME)
    fileType     String
    createdAt    DateTime     @default(now())
    updatedAt    DateTime     @updatedAt

    @@map("job_seeker_documents")
}

model JobSeekerCulturePreferences {
    id                       String    @id @default(uuid())
    jobSeeker                JobSeeker @relation(fields: [jobSeekerId], references: [id], onDelete: Cascade)
    jobSeekerId              String    @unique
    nextJobGoals             String?
    workMotivation           String?
    workStylePreference      String?
    preferredWorkEnvironment String?
    createdAt                DateTime  @default(now())
    updatedAt                DateTime  @updatedAt

    @@map("job_seeker_culture_preferences")
}

enum AuthProvider {
    GOOGLE
    PHONE_NUMBERI
    LINKEDIN
}

enum PrimaryInterest {
    TECH_DEVELOPER_ENGINEER
    PRODUCT_MANAGEMENT
    UI_UX_DESIGN
    MARKETING_GROWTH
    SALES_BD
    HR_TALENT
    OPERATIONS
    FINANCE
    LEGAL_COMPLIANCE
    CONTENT_COPYWRITING
    GENERALIST
}

enum JobSeekerStatus {
    FRESHER
    EXPERIENCED
}

enum ActivelyLookingStatus {
    ACTIVELY_LOOKING
    OPEN_TO_WORK
    NOT_LOOKING_NOW
}

enum WorkArrangement {
    REMOTE
    HYBRID
    ON_SITE
}

enum StartupStagePreference {
    IDEA_STAGE
    GROWTH_STAGE
    MATURE_STAGE
}

enum JobType {
    INTERNSHIPS
    FULL_TIME
    PART_TIME
    CO_FOUNDER
    ADVISOR_MENTOR
}

enum DocumentType {
    RESUME
    COVER_LETTER
    PORTFOLIO
}

enum UserRole {
    JOBSEEKER
    RECRUITER
    ADMIN
}

// ======================== RECUIRTER SECTION ========================

model Recruiter {
    id                 String   @id @default(uuid())
    designation        String?
    location           String?
    profilePicture     String?
    tagline            String?
    aboutCompany       String?  @db.VarChar(2000)
    skillSet           String[]
    communityProfileId String?
    createdAt          DateTime @default(now())
    updatedAt          DateTime @updatedAt

    company CompanyProfile? @relation("RecuirterToCompanyProfile")

    userId String @unique
    user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

    @@map("recruiters")
}

model Job {
    id          String  @id @default(uuid())
    title       String
    description String
    location    String
    salaryRange String?

    companyId String
    company   CompanyProfile @relation(fields: [companyId], references: [id], onDelete: Cascade)

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@map("jobs")
}

model CompanyProfile {
    id                 String   @id @default(uuid())
    role               String
    companyName        String
    companyType        String?
    companyPic         String?
    websiteLink        String?
    socialLinks        String[]
    location           String?
    companyStage       String?
    companySize        String?
    foundedIn          Int?
    foundedYear        String?
    workEmail          String?
    companySummary     String?
    fundingDetails     String?
    profileView        Int      @default(0)
    totalOpenPositions Int      @default(0)
    createdAt          DateTime @default(now())
    updatedAt          DateTime @updatedAt

    jobs Job[]

    recruiterId String    @unique
    recruiter   Recruiter @relation("RecuirterToCompanyProfile", fields: [recruiterId], references: [id], onDelete: Cascade)

    @@map("company_profiles")
}

// ======================= COMMON MODULE ============================

model Profile {
    id             String  @id @default(uuid())
    age            Int?
    name           String
    email          String  @unique
    gender         String?
    phoneNumber    String? @unique
    bio            String?
    tagline        String?
    profilePicture String?
    userId         String  @unique
    user           User    @relation(fields: [userId], references: [id],onDelete: Cascade)

    @@map("profile")
}

model Experience {
    id              String           @id @default(uuid())
    userId          String           @unique
    user            User             @relation(fields: [userId], references: [id],onDelete: Cascade)
    workExperiences WorkExperience[]

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@map("experiences")
}

model WorkExperience {
    id           String     @id @default(uuid())
    experienceId String
    experience   Experience @relation(fields: [experienceId], references: [id], onDelete: Cascade)

    title          String
    employmentType String
    company        String
    startMonth     Int?
    startYear      Int?
    endMonth       Int?
    endYear        Int?

    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt

    @@map("work_experiences")
}

// ======================== COMMUNITY SECTION ========================

model Post {
    id           Int           @id @default(autoincrement())
    content      String        @db.VarChar(5000)
    community    CommunityType
    createdAt    DateTime      @default(now())
    updatedAt    DateTime      @updatedAt
    likeCount    Int           @default(0)
    commentCount Int           @default(0)

    userId String
    user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

    media    PostMedia[]
    comments Comment[]

    @@index([userId])
    @@index([community])
    @@index([createdAt])
    @@map("posts")
}

model PostMedia {
    id        String        @id @default(uuid())
    url       String
    mediaType PostMediaType
    postId    Int?
    post      Post?         @relation(fields: [postId], references: [id], onDelete: Cascade)

    @@index([postId])
    @@map("posts_media")
}

model Comment {
    id        String   @id @default(uuid())
    message   String
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    likeCount Int      @default(0)
    postId    Int
    post      Post     @relation(fields: [postId], references: [id], onDelete: Cascade)
    userId    String
    user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

    @@index([postId])
    @@index([userId])
    @@index([createdAt])
    @@map("post_comments")
}

model EntityLike {
    id         String     @id @default(uuid())
    entityId   String
    entityType EntityType
    likedAt    DateTime   @default(now())
    userId     String
    user       User       @relation(fields: [userId], references: [id], onDelete: Cascade)

    @@unique([entityId, entityType, userId])
    @@index([entityId, entityType])
    @@index([userId])
    @@index([likedAt])
    @@map("entity_likes")
}

enum CommunityType {
    FINTECH
    HEALTHTECH
    AGRITECH
    D2C_ECOMMERCE
    EDTECH
    AI_ML_DEEPTECH
    HR_TECH
    CREATOR_ECONOMY
    CLIMATE_TECH
    SAAS
    WEB3_BLOCKCHAIN
    OTHER_DOMAINS
    BANGALORE_STARTUPS
    PUNE_STARTUPS
    DELHI_NCR_STARTUPS
    TIER2_CITY_STARTUPS
    REMOTE_GLOBAL_STARTUPS
    ASKUP
    IDEA2GO
    STARTFIRST
    PROOFZONE
    BUILDCORE
    SCALEMODE
    PITCHPLAY
}

enum PostMediaType {
    IMAGE
    VIDEO
}

enum EntityType {
    POST
    COMMENT
}
